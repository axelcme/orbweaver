<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta
			name="description"
			content="Gardens that change you. Cowichan Valley's mindful alternative to lawn warfare. Natural landcare services including garden coaching, gentle maintenance, and permaculture design."
		/>
		<meta property="og:title" content="Orbweaver Natural Landcare" />
		<meta
			property="og:description"
			content="Your lawn wants to be a garden. Natural landcare services in Cowichan Valley."
		/>
		<meta property="og:type" content="website" />
		<title>Orbweaver Natural Landcare</title>

		<!-- Favicon placeholder - add your own favicon.ico to root directory -->
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		
		<!-- Preload LCP image for faster loading -->
		<link rel="preload" as="image" href="/images/hero-800.avif" type="image/avif" />
		<link rel="preload" as="image" href="/images/hero-800.webp" type="image/webp" />
		<link rel="preload" as="image" href="/images/hero-800.jpg" type="image/jpeg" />

		<!-- Google Fonts for rounded, friendly typography -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600&family=Quicksand:wght@400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		
		<!-- Minified CSS for performance -->
		<link rel="stylesheet" href="styles.min.css" />
	</head>
	<body>
		<header>
			<h1>Orbweaver</h1>
			<h2>Natural Landcare</h2>
			<a href="tel:250-710-1010" class="btn btn-secondary header-phone"
				>250&#8209;710&#8209;1010</a
			>
			<div class="hero-image">
				<picture>
					<source 
						srcset="/images/hero-800.avif 800w, /images/hero-1200.avif 1200w" 
						type="image/avif"
						sizes="(max-width: 600px) 100vw, 800px"
					/>
					<source 
						srcset="/images/hero-800.webp 800w, /images/hero-1200.webp 1200w" 
						type="image/webp"
						sizes="(max-width: 600px) 100vw, 800px"
					/>
					<img
						src="/images/hero-800.jpg"
						srcset="/images/hero-800.jpg 800w, /images/hero-1200.jpg 1200w"
						sizes="(max-width: 600px) 100vw, 800px"
						alt="natural meadowscape"
						fetchpriority="high"
						width="800"
						height="533"
					/>
				</picture>
				<div class="hero-overlay">
					<h2>Your lawn wants to be a garden.</h2>
					<a href="#contact-form" class="btn btn-primary"
						>Start a conversation</a
					>
				</div>
			</div>
		</header>

		<main>
			<p>
				There's a different way to think about your outdoor space. One
				where you work with nature instead of declaring war on it every
				Sunday.
			</p>

			<blockquote>
				<p>
					We've been told land needs constant control. Trim this.
					Spray that. Fight back the chaos.
				</p>
				<p>
					But what if your garden already knows what it wants to
					become? What if the secret is just learning how to listen?
				</p>
				<p>
					That's what we'll do. We'll observe, we'll understand, then
					we'll guide. The result? Alive and abundant spaces that
					basically take care of themselves.
				</p>
			</blockquote>

			<section>
				<h2>How we work</h2>

				<div class="cards-wrapper">
					<div
						class="cards-container"
						id="howWeWorkCards"
						tabindex="0"
						role="region"
						aria-label="How we work services carousel"
					>
						<article>
							<h3>Build soil, not dependencies</h3>
							<p>
								Healthy soil grows healthy plants. We focus on
								building living soil that gets better each year,
								not dependent on fertilizers or other
								amendments.
							</p>
						</article>

						<article>
							<h3>Plant for the long term</h3>
							<p>
								We choose plants that actually want to grow
								here, from seeds that were born here. They'll
								need less water and care once established.
							</p>
						</article>

						<article>
							<h3>Welcome wildlife</h3>
							<p>
								A balanced garden has predators for every pest.
								We design habitats that attract and shelter
								beneficial insects, reptiles, and birds.
							</p>
						</article>

						<article>
							<h3>Capture rain where it falls</h3>
							<p>
								Using simple earthworks and plantings that slow
								and sink water, we reduce or eliminate
								irrigation needs and prevent erosion.
							</p>
						</article>
					</div>
					<div class="carousel-dots" id="howWeWorkDots"></div>
				</div>

				<aside>
					<h3>Quiet work</h3>
					<p>
						We work with the land, not against it.<br />
						We use scythes, not mowers. Hand tools, not blowers.
						<br />
						Your neighbours will thank you.
					</p>
				</aside>
			</section>

			<section>
				<h2>What we do</h2>

				<div class="cards-wrapper">
					<div
						class="cards-container"
						id="whatWeDoCards"
						tabindex="0"
						role="region"
						aria-label="What we do services carousel"
					>
						<article>
							<h3>Garden coaching</h3>
							<p>For the curious</p>
							<p>
								Think of us as your garden translator.
								We&rsquo;ll teach you to read what your plants
								are actually saying, build soil that's genuinely
								alive, and create abundance without the
								struggle.
							</p>
							<p>
								<mark
									>Perfect if you want to learn but don't know
									where to start.</mark
								>
							</p>
						</article>

						<article>
							<h3>Gentle maintenance</h3>
							<p>For the busy</p>
							<p>
								Regular care that makes your garden more
								independent over time, not less. We prune for
								health, not conformity. Build soil, not deplete
								it. Every visit moves you closer to a
								self-sustaining ecosystem.
							</p>
							<p>
								<mark
									>It's maintenance that has an exit
									strategy.</mark
								>
							</p>
						</article>

						<article>
							<h3>Full garden design</h3>
							<p>For the ready</p>
							<p>
								Let's create something extraordinary. Native
								plants that actually want to be here. Food
								forests that look like art installations. Rain
								gardens that solve problems whilst creating
								beauty.
							</p>
							<p>
								<mark>This is landscape as possibility.</mark>
							</p>
						</article>
					</div>
					<div class="carousel-dots" id="whatWeDoDots"></div>
				</div>

				<div class="boundaries">
					<strong>What we don&rsquo;t do:</strong>
					<p>No plastic, no poison, no petroleum.</p>
					<p>
						No mowing, blowing, irrigation installation,
						hardscaping, or anything requiring heavy machinery. For
						those services, we know excellent people to recommend.
					</p>
					<p>
						No lawns. We'll do <i>area rugs</i> of bee turf, but we
						think it's time to move on from <i>wall-to-wall</i>.
					</p>
					<p>
						As for 'weedeating', we won't run a string trimmer but
						we might make them into a salad.
					</p>
				</div>
			</section>

			<section id="contact-form">
				<h2>Start something</h2>

				<form
					id="contactForm"
					action="https://formspree.io/f/xyzdqbaw"
					method="POST"
				>
					<p>
						Tell us about your space and we'll start a conversation.
						No pressure, no sales pitch. Just two people talking
						about plants.
					</p>

					<label>
						Name
						<input
							type="text"
							name="name"
							placeholder="What should we call you?"
							required
						/>
					</label>

					<label>
						Email
						<input
							type="email"
							name="email"
							placeholder="your@email.com"
							required
						/>
					</label>

					<label>
						Phone (optional)
						<input
							type="tel"
							name="phone"
							placeholder="250-xxx-xxxx"
						/>
					</label>

					<label>
						City (optional)
						<input
							type="text"
							name="city"
							placeholder="Where do your plants live?"
						/>
					</label>

					<!-- Hidden field for Formspree -->
					<input
						type="hidden"
						name="_subject"
						value="New inquiry from Orbweaver website"
					/>

					<label>
						What's happening with your outdoor space?
						<textarea
							name="message"
							rows="4"
							placeholder="Honest assessment welcome. 'Total disaster' is a perfectly valid starting point."
							required
						></textarea>
					</label>

					<label>
						What service interests you most?
						<select name="service">
							<option value="">Choose one (optional)</option>
							<option value="coaching">Garden coaching</option>
							<option value="maintenance">
								Gentle maintenance
							</option>
							<option value="design">Full garden design</option>
							<option value="consultation">
								Just a consultation
							</option>
						</select>
					</label>

					<!-- Honeypot field for spam prevention -->
					<div
						style="position: absolute; left: -5000px"
						aria-hidden="true"
					>
						<input type="text" name="website" tabindex="-1" />
					</div>

					<button type="submit" class="btn btn-primary">
						Let's talk
					</button>
					<div
						id="formMessage"
						class="form-message"
						style="display: none"
					></div>
				</form>

				<div class="service-details">
					<div>
						<strong>Service area:</strong> &#8216;Cowichan
						Valley&#8217;
					</div>
					<div><strong>Consultation:</strong> $150 (incl. taxes)</div>
					<div><strong>Response time:</strong> Within one week.</div>
					<div><strong>Availability:</strong> Year-round. Booking fall '25 starts.</div>
				</div>
			</section>
		</main>

		<footer>
			<p>
				<strong>Orbweaver Natural Landcare</strong><br />
				Quw&rsquo;utsun Traditional Lands<br />
			</p>
			<small>Beautiful outdoor spaces, without the warfare.</small>
		</footer>

		<script src="smartquotes.js"></script>
		<script>
			smartquotes();
		</script>

		<script>
			// Carousel state management to prevent flickering
			const carouselState = {};

			// Throttle function to limit scroll event frequency
			function throttle(func, limit) {
				let inThrottle;
				return function() {
					const args = arguments;
					const context = this;
					if (!inThrottle) {
						func.apply(context, args);
						inThrottle = true;
						setTimeout(() => inThrottle = false, limit);
					}
				}
			}

			// Initialize carousels with improved performance
			function initCarousels() {
				const carousels = [
					{ containerId: "howWeWorkCards", dotsId: "howWeWorkDots" },
					{ containerId: "whatWeDoCards", dotsId: "whatWeDoDots" },
				];

				carousels.forEach((config) => {
					const container = document.getElementById(config.containerId);
					const dotsContainer = document.getElementById(config.dotsId);

					if (!container || !dotsContainer) return;

					const cards = container.querySelectorAll("article");
					
					// Initialize or retrieve state for this carousel
					if (!carouselState[config.containerId]) {
						carouselState[config.containerId] = { 
							currentIndex: 0,
							scrollHandler: null
						};
					}

					// Add keyboard navigation (only once per container)
					if (!container.dataset.keyboardInit) {
						container.dataset.keyboardInit = 'true';
						container.addEventListener("keydown", (e) => {
							if (!cards.length) return;

							const cardWidth = cards[0].offsetWidth + 16;
							const currentScroll = container.scrollLeft;
							const currentIndex = Math.round(currentScroll / cardWidth);

							if (e.key === "ArrowRight") {
								e.preventDefault();
								const nextIndex = Math.min(currentIndex + 1, cards.length - 1);
								container.scrollTo({
									left: nextIndex * cardWidth,
									behavior: "smooth",
								});
							} else if (e.key === "ArrowLeft") {
								e.preventDefault();
								const prevIndex = Math.max(currentIndex - 1, 0);
								container.scrollTo({
									left: prevIndex * cardWidth,
									behavior: "smooth",
								});
							}
						});
					}

					if (window.innerWidth <= 768 && cards.length > 0) {
						// Create or update dot indicators
						if (dotsContainer.children.length !== cards.length) {
							dotsContainer.innerHTML = "";
							cards.forEach((_, index) => {
								const dot = document.createElement("span");
								dot.classList.toggle('active', 
									index === carouselState[config.containerId].currentIndex);
								dotsContainer.appendChild(dot);
							});
						}

						// Remove old scroll handler if it exists
						if (carouselState[config.containerId].scrollHandler) {
							container.removeEventListener('scroll', carouselState[config.containerId].scrollHandler);
						}

						// Create throttled scroll handler
						const updateDots = throttle(() => {
							const scrollPosition = container.scrollLeft;
							const cardWidth = cards[0].offsetWidth + 16;
							const currentIndex = Math.round(scrollPosition / cardWidth);

							// Only update if index actually changed
							if (carouselState[config.containerId].currentIndex !== currentIndex) {
								carouselState[config.containerId].currentIndex = currentIndex;
								
								// Use requestAnimationFrame for smooth visual updates
								requestAnimationFrame(() => {
									const dots = dotsContainer.querySelectorAll("span");
									dots.forEach((dot, index) => {
										dot.classList.toggle("active", index === currentIndex);
									});
								});
							}
						}, 100); // Throttle to 100ms

						// Store and add new scroll handler
						carouselState[config.containerId].scrollHandler = updateDots;
						container.addEventListener("scroll", updateDots, { passive: true });
						
						// Restore scroll position if returning to mobile view
						if (carouselState[config.containerId].currentIndex > 0) {
							const cardWidth = cards[0].offsetWidth + 16;
							container.scrollLeft = carouselState[config.containerId].currentIndex * cardWidth;
						}
					} else {
						// Clear dots on desktop
						dotsContainer.innerHTML = "";
						// Remove scroll handler on desktop
						if (carouselState[config.containerId].scrollHandler) {
							container.removeEventListener('scroll', carouselState[config.containerId].scrollHandler);
							carouselState[config.containerId].scrollHandler = null;
						}
					}
				});
			}

			// Initialize carousels on load
			window.addEventListener("load", initCarousels);
			
			// Debounced resize handler to prevent excessive re-initialization
			let resizeTimeout;
			window.addEventListener("resize", () => {
				clearTimeout(resizeTimeout);
				resizeTimeout = setTimeout(() => {
					initCarousels();
				}, 250);
			});

			// Form submission handler
			document
				.getElementById("contactForm")
				.addEventListener("submit", async function (e) {
					e.preventDefault();

					const form = e.target;
					const formData = new FormData(form);
					const btn = form.querySelector('button[type="submit"]');
					const messageDiv = document.getElementById("formMessage");

					// Check honeypot
					if (formData.get("website")) {
						return; // Bot detected, silently fail
					}

					// Disable button and show loading state
					btn.textContent = "Sending...";
					btn.disabled = true;
					messageDiv.style.display = "none";

					try {
						// Send to Formspree
						const response = await fetch(
							"https://formspree.io/f/xyzdqbaw",
							{
								method: "POST",
								headers: {
									Accept: "application/json",
								},
								body: formData, // Send FormData directly
							}
						);

						const result = await response.json();

						if (response.ok) {
							// Show success message
							messageDiv.textContent =
								"Message received! We'll be in touch within a week.";
							messageDiv.className = "form-message success";
							messageDiv.style.display = "block";

							// Reset form
							form.reset();

							// Reset button after delay
							setTimeout(() => {
								btn.textContent = "Let's talk";
								btn.disabled = false;
								messageDiv.style.display = "none";
							}, 5000);
						} else {
							// Handle Formspree errors
							const errorMsg =
								result.error ||
								"Form submission failed. Please try again.";
							throw new Error(errorMsg);
						}
					} catch (error) {
						// Show error message
						console.error("Form error:", error);
						messageDiv.textContent =
							error.message ||
							"Something went wrong. Please try again or email us directly.";
						messageDiv.className = "form-message error";
						messageDiv.style.display = "block";

						btn.textContent = "Let's talk";
						btn.disabled = false;
					}
				});

			// Add smooth scroll behaviour for any internal links
			document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
				anchor.addEventListener("click", function (e) {
					e.preventDefault();
					const target = document.querySelector(
						this.getAttribute("href")
					);
					if (target) {
						target.scrollIntoView({ behavior: "smooth" });
					}
				});
			});
		</script>
	</body>
</html>